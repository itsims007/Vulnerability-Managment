<p align="center">
<img src="https://imgur.com/i10S5cr.png" alt="Nessus Logo"/>
</p>

<h1>Vulnerability Managment using Nessus</h1>
This tutorial outlines the implementation of the vulnerability scanner Nessus.<br />


<h2>Environments and Technologies Used</h2>

- VMware
- Nessus Vulnerability Scanner

<h2>Operating Systems Used </h2>

- Windows 10 (21H2)


<h2>Deployment and Configuration Steps</h2>

First, create a VM running Windows 10 using VMware. Here are the links for VMware and the Windows 10 ISO file: https://www.microsoft.com/en-us/software-download/windows10 and https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html. Once created, we're going to want to ensure connectivity between the VM and the host machine(your own computer). Find the IPv4 address of the VM by typing "ipconfig" from the command prompt and then on the host machine, try to ping the VM using the it's IP address. The request will time out so we'll need to change VM's firewall settings.
<p>
<img src="https://imgur.com/1fWQqtU.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />

In VM2, type in wf.msc in the search and then click "Windows Defender Firewall Properties". From there, for the Domain, Private, and Public profiles, turn off the firewalls. From VM1 attempt to ping VM2 again, this time it should not time out which means the VMs are connected on the same network. 
<p>
<img src="https://imgur.com/bjGIIzl.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<img src="https://imgur.com/q5g5RuI.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p>
</p>
<br />

Great! Next we're going to download and install Nessus onto VM1 using this link: https://www.tenable.com/products/nessus/nessus-essentials . We'll have to create a username and password to continue the installation. This will take a while.
<p>
<img src="https://imgur.com/kvmeK1a.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />

Once its finished, let's create a new scan. For the name of the scan, you can make it whatever you want. The name I chose will be "Windows 10 Single Host". For the target, type the IP address of the VM. Hit save then run the scan. Wait for the scan to finish. Once finished, we can see the results of the scan. As we can see, not many high or critical vulnerabilities have been detected. This is because we performed a non-credentialed scan. Also, feel free to look around the scan and click on vulnerabilities as this will show you more information on each vulnerability.
<p>
<img src="https://imgur.com/GLO1WHp.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<img src="https://imgur.com/kNvz8RN.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p>
</p>
<br />

Now weâ€™re going to perform a credentialed scan. First, we have to configure VM2 for credentialed scans. Go to "Services" in the VM and enable "Remote Registry". Next, go to "Advanced Sharing settings" and make sure "file and printer sharing" is turned on. After that, go to "User Account Control Settings" and set it to "Never notify". Then go to Registry Editor and navigate as shown in the 4th slide below and create a new DWORD named "LocalAccountTokenFilterPolicy" and set its value to 1. Restart the VM. Now we can perform a credential scan.
<p>
<img src="https://imgur.com/wiwNrm1.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<img src="https://imgur.com/kvTZhp7.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<p>
<img src="https://imgur.com/acFd2z6.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<img src="https://imgur.com/RP7meCN.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />

Go back to Nessus and add the credentials to the scan. The username and password are the ones you created for the VM. Then hit save. Launch the scan again.
<p>
<img src="https://imgur.com/3Cmdbw5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />

With the credentialed scan, we can see that there are high and critical vulnerabilities that have been detected. Next, we're going to install a deprecated version of Firefox onto the VM, perform a scan, and see how that affects the results. Go here to download it: https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/ . Once installed, run the scan. The results show that there are numerous critical vulnerabilities due to the old software being installed on VM.
<p>
<img src="https://imgur.com/Gyzd9Yb.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />

Once installed, run another scan. The results show that there are numerous critical vulnerabilities due to the old software being installed on VM.
<p>
<img src="https://imgur.com/hF61TEO.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />

In order to remediate these critical vulnerabilites, let's look for updates for Windows and uninstall the deprecated version of Firefox. Run one more scan after that, and observe the results.
<p>
<img src="https://imgur.com/Q89h5XB.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
</p>
<br />
As you can see, the amount of critical vulnerabilities has decreased. Hopefully this tutorial helped you gain some familiarity with Nessus! 

CONFIRM CONNECTIVITY BETWEEN BOTH VMs
                                                                                                <p>
<img src="https://i.imgur.com/hthqRR1.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
                                                                                               <p>
<img src="https://i.imgur.com/yLZTRBu.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
                                                                                               <p>
<img src="https://i.imgur.com/P0zHZpE.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
It is very important to make sure both VMs communicate with each other. First, communication was tested with a "ping -t" command and it failed. It sent back a "request timed out" response. Next, I enabled ICMPv4 protocol in the local windows firewall. After doing that, I tested the connection again and the a "ping -t" command and it was a success! A reply was received.
</p>
                                                                                                
INSTALL ACTIVE DIRECTORY

<p>
<img src="https://i.imgur.com/RC5pgqC.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>                                                                                                                                                                                            <p>
<img src="https://i.imgur.com/FFlWk7C.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
                                                                                               
<p>
Install Active Directory Domain Services. Then setup a new forest as mydomain.com.
</p>
                                                                                                 
CREATE AN ADMIN AND NORMAL USER ACCOUNG IN ACTIVE DIRECTORY

<p>
<img src="https://i.imgur.com/VpUKuwf.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
Created a normal user named Jane Doe. Then added her to the ADMINS group.
</p>

JOIN CLIENT1 TO DOMAIN (MYDOMAIN.COM)

<p>
<img src="https://i.imgur.com/UiC09tQ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
<img src="https://i.imgur.com/lLhwqIM.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
From the Azure portal, I set Client1's DNS settings to the DC's private Ip address..
</p>


SETUP REMOTE DESKTOP FOR NON-ADMINISTRATIVE USERS ON CLIENT 1

<p>
<img src="https://i.imgur.com/CK0jdba.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>

CREATE MULTIPLE ADDITIONAL USERS TO CREATE A DATABASE OF USERS
                                                                                               
<p>
<img src="https://i.imgur.com/R6jRhtK.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
To create 10000 additional randomly name uses, I used a script that would execute the solution.
</p>
<br />


<br />
